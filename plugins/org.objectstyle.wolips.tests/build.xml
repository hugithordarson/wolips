<?xml version="1.0"?>
 
<!-- ======================================================== -->
<!--        Main WOLips plugins Ant build file                -->
<!-- Serves as a facade for different helper build files.     -->
<!-- ======================================================== -->
<project name="org.objectstyle.wolips.tests" default="" basedir=".">

    <property file="default.properties"/>

    <!-- ========================================== -->
    <!-- Build java.                                -->
    <!-- ========================================== -->
    <target name="java">
       <path id="classpath">
            <fileset dir="../../lib">
                <include name="**/*.jar"/>
	        </fileset>
            <fileset dir="../../../lib">
                <include name="**/*.jar"/>
	        </fileset>
            <pathelement path="../../../${build.output.java.dir}"/>
        <pathelement path = "${wo.wosystemroot}/Library/Frameworks/JavaEOAccess.framework/Resources/Java/javaeoaccess.jar"/>
	      <pathelement path = "${wo.wosystemroot}/Library/Frameworks/JavaFoundation.framework/Resources/Java/javafoundation.jar"/>
  	    <pathelement path = "${wo.wosystemroot}/Library/Frameworks/JavaEOControl.framework/Resources/Java/javaeocontrol.jar"/>
        <pathelement path = "${wo.wosystemroot}/Library/Frameworks/JavaXML.framework/Resources/Java/javaxml.jar"/>
        </path>
	    <ant dir="." antfile="../../../${project.buildscripts.dir}/plugin-project.xml" target="java">
            <property name="param.plugin.dir" value="."/>
            <property name="param.java.dest.dir" value="../../../${build.output.java.dir}"/>
            <reference refid="classpath" torefid="classpath"/>
	    </ant>
    </target>

    <!-- ========================================== -->
    <!-- Build jar.                                 -->
    <!-- ========================================== -->
    <target name="jar">
	    <patternset id="param.classes.patternset.refid">
            <include name="**/org/objectstyle/wolips/tests/**"/>
            <include name="**/org/objectstyle/wolips/**/*Test.class"/>
            <include name="**/org/objectstyle/wolips/**/*TestSuite.class"/>
            <exclude name="**/org/objectstyle/wolips/test/core/**"/>
        </patternset>
            
	    <ant dir="." antfile="../../../${project.buildscripts.dir}/plugin-project.xml" target="jar">
            <property name="param.plugin.dir" value="."/>
            <property name="param.classes.dir" value="../../../${build.output.java.dir}"/>
            <property name="param.jar.file" value="wolips-tests.jar"/>
            <reference refid="param.classes.patternset.refid"/>
            <property name="param.plugin.name" value="${plugin.name}"/>
            <property name="param.build.output.build.dir" value="../../../${build.output.build.dir}"/>
        </ant>
    </target>

    <!-- ========================================== -->
    <!-- Build copy resources.                      -->
    <!-- ========================================== -->
    <target name="copy.resources">
        <ant dir="." antfile="../../../${project.buildscripts.dir}/plugin-project.xml" target="copy.resources">
            <property name="param.plugin.dir" value="."/>
            <property name="param.build.output.build.dir" value="../../../${build.output.build.dir}"/>
            <property name="param.plugin.name" value="${plugin.name}"/>
	    </ant>
    </target>

    <!-- ========================================== -->
    <!-- Build all.                                 -->
    <!-- ========================================== -->
    <target name="all" depends="copy.resources,java,jar">
    </target>
 
    <!-- ========================================== -->
    <!-- Build dist.                                -->
    <!-- ========================================== -->
    <target name="dist">
        <ant dir="." antfile="../../../${project.buildscripts.dir}/plugin-project.xml" target="dist">
            <property name="param.plugin.name" value="${plugin.name}"/>
            <property name="param.build.output.build.dir" value="../../../${build.output.build.dir}"/>
            <property name="param.build.dist.build.dir" value="../../../${build.output.dist.dir}"/>
	    </ant>
    </target>

    <!-- ============================================= -->
    <!-- Build test.                                   -->
    <!-- Required parameters                           -->
    <!-- param.eclipse.home the eclipse home directory -->
    <!-- ============================================= -->
    
    <target name="test">
        <ant dir="scripts" antfile="run_tests.xml" target="all">
            <property name="param.eclipse.home" value="${param.eclipse.home}"/>
        </ant>
    </target>

</project>
